<html lang="de" data-bs-theme="dark">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">

    <button class="btn btn-primary" onclick="addElement()">
        add element
    </button>
    <button class="btn btn-primary" onclick="insertElement()">
        insert element
    </button>

    <task-container id="container"></task-container>

    <script>

        class TaskContainer extends HTMLElement {
            constructor() {
                super();
                this.attachShadow({ mode: 'open' });
                this.elementList = [];
                this.rows = [];
                this.render();
            }

            render() {
                this.shadowRoot.innerHTML = `
                    <div class="container text-center">
                        <slot></slot>
                    </div>
                `;
            }

            connectedCallback() {
                this.classList.add('container');
            }

            addElement(/**@type {HTMLElement}*/element) {
                this.elementList.push(element);
                
                if (this.rows.length === 0) {
                    const newRow = new Row();
                    this.appendChild(newRow);
                    this.rows.push(newRow);
                }

                this.rows[0].addElement(element);
            }

            insertElement(/**@type {HTMLElement}*/element, rowIndex, colIndex) {
                if (this.rows.length -1 < rowIndex) {
                    const newRow = new Row();
                    this.appendChild(newRow);
                    this.rows.push(newRow);
                    newRow.addElement(element, colIndex);
                }
            }
        }

        class Row extends HTMLElement {
            constructor() {
                super();
                this.cols = [];
            }

            connectedCallback() {
                this.classList.add('row', 'd-inline-flex', 'text-center');
            }

            addElement(element) {
                const col = new Column(element);
                this.appendChild(col);
                this.cols.push(col);
            }

            addElement(element, index) {
                const col = new Column(element);
                this.appendChild(col);
                this.cols.push(col);
            }
        }

        class Column extends HTMLElement {
            constructor(element) {
                super();
                this.element = element;
            }

            connectedCallback() {
                this.classList.add('col');
                this.appendChild(this.element);
            }
        }


        customElements.define('task-container', TaskContainer);
        customElements.define('task-row', Row);
        customElements.define('task-col', Column);

        function addElement(){
            /** @type {TaskContainer} */
            const container = document.getElementById('container');
            const element = document.createElement('div');
            element.innerHTML = 'element';
            container.addElement(element);
        }

        function insertElement(){
            /** @type {TaskContainer} */
            const container = document.getElementById('container');
            const element = document.createElement('div');
            element.innerHTML = 'element5';
            container.insertElement(element, 1, 2);
        }
    </script>
</html>